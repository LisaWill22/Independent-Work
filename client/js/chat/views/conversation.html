<div class="row">
    <div class="col-sm-offset-3 col-sm-6 text-center">
        <img ng-show="!otherUser.image.base64URL"
             class="img img-circle img-thumbnail img-avatar img-default img-md ng-show-fade"
             ng-src="https://www.fmtv.com/static/img/pages/default-user-avatar.jpg" alt="...">
        <img ng-show="otherUser.image.base64URL"/
             class="img img-circle img-thumbnail img-avatar img-md mbn ng-show-fade"
             ng-src="data:image/png;base64,{{otherUser.image.base64URL}}">
        <h4 class="lead"> <i class="fa fa-fw fa-2x fa-comments"></i> with {{ otherUser.firstName }} {{ otherUser.lastName}}</h4>
        <a href="#" ui-sref="app.contractors.profile({ id: otherUser._id })">View profile</a>
        <br/>
        <br/>
    </div>
</div>
<div class="row">
    <div class="col-xs-10 col-xs-offset-1 col-sm-8 col-sm-offset-2 col-md-6 col-md-offset-3 col-lg-4 col-lg-offset-4 text-center">

        <!-- CHAT MESSAGES -->
        <div class="chat-wrapper" id="chat-container">
            <div class="ng-show-fade" ng-show="chatThread && chatThread.chats.length">
                <div class="panel panel-chat animate-fade-in" ng-repeat="message in chatThread.chats">
                    <div class="chat-control-buttons" ng-show="message.sender === currentUser._id">
                        <button class="btn btn-link" ng-click="deleteChatMessage(message)">
                            <i class="fa fa-fw fa-lg fa-remove"></i>
                        </button>
                        <button class="btn btn-link" ng-click="editChatMessage(message)">
                            <i class="fa fa-fw fa-lg fa-pencil"></i>
                        </button>
                    </div>
                    <div class="panel-body panel-halfp panel-chat-message"
                         ng-class="{
                             'text-right sender': message.sender === currentUser._id,
                             'text-left receiver': message.sender !== currentUser._id }">
                        <h5 class="mtn"
                            ng-class="{
                             'text-primary': message.sender === currentUser._id,
                             'text-info': message.sender !== currentUser._id }">
                            <span ng-show="message.sender !== currentUser._id">
                                {{ otherUser.firstName }} {{ otherUser.lastName }}
                            </span>
                            <small>{{ message._dateSent | date:'short'}}</small>
                        </h5>
                        {{ message.message }}
                    </div>
                </div>
            </div>

            <div class="ng-show-fade" ng-show="(chatThread && !chatThread.chats.length) || !chatThread">
                <p class="lead">No messages yet, starting chatting!</p>
            </div>
        </div>

        <!-- CHAT SENDING CONTROL-->
        <form bo-form
              autocomplete="off"
              novalidate
              name="chatForm"
              method="{{ chatThread._id ? 'PUT' : 'POST' }}"
              ng-on-error="onError"
              ng-before-submit="beforeSubmit"
              ng-after-submit="afterSubmit"
              ng-action="/api/users/{{ currentUser._id }}/chat/{{ otherUser._id }}">
            <div class="form-group" bo-validate>
                <textarea class="form-control chat-box block"
                          placeholder="Whatchu got to say?"
                          rows="4"
                          ng-required="true"
                          ng-model="data.message">
                </text-area>
            </div>
            <button class="btn btn-primary btn-block btn-lg"
                    type="submit"
                    name="send">
                SEND
            </button>
        </form>
    </div>

</div>
